@model SAcademy.Models.Formation

@using Microsoft.AspNetCore.Identity
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

@{
    ViewData["Title"] = "Inscription";
    string email = null;
    if (SignInManager.IsSignedIn(User))
    {
        User user = await UserManager.FindByEmailAsync(User.Identity.Name);
        if (user != null)
        {
            email = user.Email;
        }


    }
}
<div class="yeld">
    @await Component.InvokeAsync("InscriptionPage")
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-transparent">
            <li class="breadcrumb-item text-center"><a href="/"><img class="w-75" src="~/img/home.png"></a></li>
            <li class="breadcrumb-item" style="font-size:20px; color:#ce0033; cursor:pointer;" onclick="window.history.go(-2); return false;">Détails</li>
            <li class="breadcrumb-item" style="font-size:20px;"><a style="color:#ce0033 !important; text-decoration:none !important;"
                    href="/formations">Nos Formation</a></li>
            <li class="breadcrumb-item active" style="font-size:20px;" aria-current="page">Inscription</li>
        </ol>
    </nav>

    <div class="d-flex gap-5 justify-content-between inscriptionPage">
        <div class="w-50 p-5 inscriptionPage-content">
            <hr />
            <h4 class="font-weight-bold">@Model.Title</h4>
            <p>Description : @Model.Description</p>
            <p>Durée : @Model.Duration</p>
            <p>Du : @Html.DisplayFor(modelItem => Model.StartDay)</p>
            <p>Au : @Html.DisplayFor(modelItem => Model.EndDay)</p>
            <p>@Html.DisplayFor(modelItem => Model.StartTime) => @Html.DisplayFor(modelItem => Model.EndTime)</p>
            <p>Mode : @Model.Mode.Name</p>
            @if (Model.Mode.Name != "Distanciel")
            {
                <p>Ville : @Model.Ville.Name</p>
            }
            <p>Type : @Model.Type.Name</p>
            <h4 class="font-weight-bold">Presentation</h4>
            <p>@Html.Raw(Model.Presentation)</p>
            <h4 class="font-weight-bold">Compétences</h4>
            <p>@Html.Raw(Model.Skills)</p>
            <h4 class="font-weight-bold">Certification</h4>
            <p>@Html.Raw(Model.Certificate)</p>
        </div>

        <div class="w-50 d-flex justify-content-center align-items-center inscriptionPage-form mb-3">
            <form class="w-75" method="post" id="FormInscrits" name="google-sheet" asp-action="Register">
                <div class="form-group">
                    <input type="hidden" name="FormationId" class="form-control" id="exampleInputPassword1"
                        value="@Model.Id" placeholder="Nom">
                </div>
                <div class="form-group">
                    <input type="hidden" name="FormationName" class="form-control"
                           value="@Model.Title" placeholder="FormationName">
                </div>
                <div class="form-group">
                    <label>Email address</label>
                    <input type="email" readonly class="form-control dt" name="Email" value="@email" required />
                </div>
                <div class="form-group">
                    <label>Nom</label>
                    <input type="text" name="Nom" class="form-control vl" placeholder="Nom" maxlength="10" min="4" required />
                </div>
                <div class="form-group">
                    <label>Prenom</label>
                    <input type="text" class="form-control vl" name="Prenom" placeholder="Prenom" maxlength="10" required />
                </div>
                <div class="form-group">
                    <label>téléphone</label>
                    @*<input type="number" class="form-control vl" name="Phone" placeholder="téléphone" maxlength="10" required />*@
                    <input type="number" name="Phone" class="form-control vl" maxlength="11" placeholder="téléphone" required
                           oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" />
                </div>
                <div class="form-group">
                    <label>Rôle de l'emploi</label>
                    <input type="text" class="form-control vl" name="JobRole" placeholder="Rôle de l'emploi" maxlength="15" />
                </div>
                <div class="form-group">
                    <label>Nom de l'entreprise</label>
                    <input type="text" class="form-control vl" name="CompanyName" placeholder="Nom de l'entreprise" maxlength="15" />
                </div>
                <div class="form-group">
                    <label>Pays</label>
                    <input type="text" class="form-control vl" name="Region" placeholder="Region" maxlength="15" />
                </div>
                <div class="form-group">
                    <label>Ville</label>
                    <input type="text" class="form-control vl" name="Ville" placeholder="Ville" required maxlength="10" />
                </div>
                @* <div class="form-group">
                    <input type="hidden" class="form-control" name="FormationTitle" value="@Model.Title">
                    </div>
                    <div class="form-group">
                    <input type="hidden" class="form-control" name="FormationMode" value="@Model.Mode">
                    </div>*@
                @*<div class="form-group">
                    <input type="hidden" class="form-control" name="FormationVille" value="@Model.Ville.Name">
                    </div>*@
                @*<div class="form-group">
                    <input type="hidden" class="form-control" name="FormationDateStart" value="@Model.StartDay">
                    </div>*@
                <button id="inscrits" class="btn inscription w-100">Submit</button>
            </form>
        </div>
    </div>
</div>

<script>
    $(function () {
        $("#inscrits").on('click',function(e){
            e.preventDefault();
            var user = $('input[name="Nom"]').val();

            if ($('.dt').val().length === 0 || $('.vl').val().length === 0) {
                alert('Remplissez les champs');
            }else{

                swal('Bonjour ' + user, 'Merci pour votre inscription à la formation : @TempData["title"]', "success")
            .then((confirm) => {
                $("#FormInscrits").submit();
            })
            }
        });

    });
</script>